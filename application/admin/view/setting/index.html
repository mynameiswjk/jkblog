<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<title>文章列表--layui后台管理模板 2.0</title>
	<meta name="renderer" content="webkit">
	<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
	<meta name="apple-mobile-web-app-status-bar-style" content="black">
	<meta name="apple-mobile-web-app-capable" content="yes">
	<meta name="format-detection" content="telephone=no">
	<link rel="stylesheet" href="__COMMON__/layui/css/layui.css" media="all" />
</head>
<body>
  <blockquote class="layui-elem-quote layui-text" id='blockquote'>
  网站的基本设置
</blockquote>
<form class="layui-form layui-form-pane" action="">
  <div class="layui-form-item">
    <label class="layui-form-label">博主姓名</label>
    <div class="layui-input-block">
      <input type="text" name="blogger_name"  value='{$setting.blogger_name}' autocomplete="off" lay-verify="blogger_name" placeholder="请输入博主姓名" class="layui-input">
    </div>
  </div> 
  <div class="layui-form-item">
    <label class="layui-form-label">博主简介</label>
    <div class="layui-input-block">
      <input type="text" name="blogger_intro"  value='{$setting.blogger_intro}' lay-verify="blogger_intro" autocomplete="off" placeholder="请输入博主简介" class="layui-input">
    </div>
  </div> 
<div class="layui-upload" style='margin:0 0 20px 15px;'>
  <div class="layui-upload-list" style='width: 100px;height: 100px;margin: 0 10px 10px 0;border:1px solid #8072725e;'>
    {if !empty($setting.blogger_avatar)}
       <img class="layui-upload-img" id="blogger_avatar"  src="{$setting.blogger_avatar}" style='whdth:100%;height:100%;'>
    {else}
       <img class="layui-upload-img" id="blogger_avatar"  style='whdth:100%;height:100%;'>
    {/if}
  </div>
 <button type="button" class="layui-btn" id="test1">上传头像</button>
 <input type='hidden' name='blogger_avatar'  value='{$setting.blogger_avatar}'/>
</div>     
  <div class="layui-form-item">
    <label class="layui-form-label">所在地址</label>
    <div class="layui-input-inline">
      <input type="text" name="blogger_address"  value='{$setting.blogger_address}' lay-verify="blogger_address" placeholder="请输入您的所在地址" autocomplete="off" class="layui-input">
    </div>
  </div>
  <div class="layui-form-item">
    <label class="layui-form-label">QQ号</label>
    <div class="layui-input-inline">
      <input type="text" name="blogger_qq"  value='{$setting.blogger_qq}' placeholder="请输入您的QQ号" autocomplete="off" class="layui-input">
    </div>
  </div>
  <div class="layui-form-item">
    <label class="layui-form-label">邮箱地址</label>
    <div class="layui-input-inline">
      <input type="text" name="blogger_email"  value='{$setting.blogger_email}' lay-verify="email" placeholder="请输入您的邮箱" autocomplete="off" class="layui-input">
    </div>
  </div>
  <div class="layui-form-item">
    <label class="layui-form-label">GitHub地址</label>
    <div class="layui-input-inline">
      <input type="text" name="blogger_github"    value='{$setting.blogger_github}' placeholder="请输入您的GitHub地址" autocomplete="off" class="layui-input">
    </div>
  </div>
  <div class="layui-form-item" pane="">
    <label class="layui-form-label">关闭网站</label>
    <div class="layui-input-block">
      <input type="radio" name="is_close_website" value="1" title="是"  {if $setting.is_close_website eq 1}checked{/if}>
      <input type="radio" name="is_close_website" value="0" title="否"  {if $setting.is_close_website eq 0}checked{/if}>
    </div>
  </div>
  <div class="layui-form-item layui-form-text">
    <label class="layui-form-label">如需关闭网站请填写关闭原因</label>
    <div class="layui-input-block">
      <textarea placeholder="请输入内容" name ='close_website_cause'  class="layui-textarea">{$setting.close_website_cause}</textarea>
    </div>
  </div>
 <div class="layui-form-item layui-form-text">
    <label class="layui-form-label">博主的座右铭</label>
    <div class="layui-input-block">
      <textarea placeholder="请输入内容" name='blogger_motto' class="layui-textarea">{$setting.blogger_motto}</textarea>
    </div>
  </div>
  <div class="layui-form-item">
    <button class="layui-btn" lay-submit="" lay-filter="demo2">提交</button>
  </div>
</form>

<script type="text/javascript" src="__COMMON__/layui/layui.js"></script>
<!-- 注意：如果你直接复制所有代码到本地，上述js路径需要改成你本地的 -->
<script>
layui.use(['form', 'layedit', 'laydate','upload'], function(){
  var form = layui.form
  ,layer = layui.layer
  ,layedit = layui.layedit
  ,laydate = layui.laydate;
   var $ = layui.jquery
  ,upload = layui.upload;

  //普通图片上传
  var loading;
  var uploadInst = upload.render({
    elem: '#test1'
    ,url: '{:url("Setting/settingUpload")}'
    ,before:function(){
     loading = top.layer.msg('图片上传中',{icon: 16,time:false,shade:0.8});
    }
    ,done: function(res){
      top.layer.close(loading);
      if(res.code == 200) {
          $("#blogger_avatar").attr('src',res.file_url);
          $("input[name='blogger_avatar']").val(res.file_url);
      }else{
          layer.msg(res.msg,{icon:2});
      }
    }
    ,error: function(){
      //演示失败状态，并实现重传
   
    },exts: 'png|jpg|jpeg'
     ,size : 10240
  });
  //自定义验证规则
  form.verify({
   blogger_name: function(value){
      if(value.length  == 0){
        return '请输入博主名称';
      }
      if(value.length  > 12){
        return '博主名称必须小于12位';
      }
    }
    ,blogger_intro: function(value){
      if(value.length  == 0){
        return '请输入博主简介';
      }
    },blogger_address: function(value){
      if(value.length  == 0){
        return '请输入所在地址';
      }
    }
    ,content: function(value){
      layedit.sync(editIndex);
    }
  });
  
  //监听提交
  form.on('submit(demo2)', function(data){
/*    layer.alert(JSON.stringify(data.field), {
      title: '最终的提交信息'
    })*/
    var field           = data.field;
    var blogger_name    = field.blogger_name;
    var blogger_address = field.blogger_address;
    var blogger_email   = field.blogger_email;
    var blogger_github  = field.blogger_github;
    var blogger_intro   = field.blogger_intro;
    var blogger_motto   = field.blogger_motto;
    var blogger_qq      = field.blogger_qq;
    var close_website_cause = field.close_website_cause;
    var is_close_website    = field.is_close_website;
    var blogger_avatar      = field.blogger_avatar;
    $.post("{:url('Setting/index')}"
      ,{blogger_name:blogger_name,blogger_address:blogger_address,blogger_email:blogger_email,blogger_github:blogger_github,blogger_intro:blogger_intro,blogger_motto:blogger_motto,blogger_qq:blogger_qq,close_website_cause:close_website_cause,is_close_website:is_close_website,blogger_avatar:blogger_avatar}
      ,function(res){
          if(res.code == 200) {
            layer.msg(res.msg,{icon:1,time:2000},function(){
              location.reload();
            });
          }else{
            layer.msg(res.msg,{icon:2});
          }
      }
      ,'json');

    return false;
  });
});
</script>

</body>
</html>